| 地址范围          | 描述           | 类型    | 读写属性 | 单位 / 说明                                                                           |
| ------------- | ------------ | ----- | ---- | --------------------------------------------------------------------------------- |
| **5000**      | 故障信息         | 输入寄存器 | 只读   | `uint16_t`，见“故障信息说明”表                                                             |
| **5001–5002** | 实时转速         | 输入寄存器 | 只读   | `int`，电角度转速，erpm = rpm × 磁极对数                                                     |
| **5003**      | 实时占空比        | 输入寄存器 | 只读   | `short`，范围 −1000 ~ 1000                                                           |
| **5004**      | 实时功率         | 输入寄存器 | 只读   | `short`，单位 W                                                                      |
| **5005**      | 实时输入电压       | 输入寄存器 | 只读   | `short`，单位 V                                                                      |
| **5006**      | 实时电机电流       | 输入寄存器 | 只读   | `short`，单位 10 mA                                                                  |
| **5007**      | 实时总线电流       | 输入寄存器 | 只读   | `short`，单位 10 mA                                                                  |
| **5008**      | 实时温度         | 输入寄存器 | 只读   | `short`，单位 ℃                                                                      |
| **5009**      | 实时角度         | 输入寄存器 | 只读   | `uint16_t`，单位 0.01°                                                               |
| **5010–5011** | 实时位置         | 输入寄存器 | 只读   | `int`，单位 0.01°，角度累加值                                                              |
| **5012**      | 回零状态         | 输入寄存器 | 只读   | 高 8 位=状态(0 进行中 / 1 完成)；低 8 位=代码(0 成功 / −1 IO未设 / −2 中止)                           |
| **5013**      | 编码器 Z 信号状态   | 输入寄存器 | 只读   | `uint16_t`，1 = 找到 Z 信号；0 = 未找到                                                    |
| **5014–5018** | 历史错误 1–5     | 输入寄存器 | 只读   | `uint16_t`，依次保存缓存错误                                                               |
| **5019**      | 输入 IO 状态     | 输入寄存器 | 只读   | `uint16_t`，低 8 位 in1 起，为 1 有效 0 无效                                                |
| **5020**      | 输出 IO 状态     | 输入寄存器 | 只读   | `uint16_t`，低 8 位 out1 起，为 1 有效 0 无效                                               |
| **6000**      | 心跳包          | 保持寄存器 | 读写   | `uint16_t`，需周期更新，否则停止电机                                                           |
| **6001**      | 控制模式         | 保持寄存器 | 读写   | 0 电流；1 转速；2 占空比；3 绝对位置；4 相对上次目标；5 相对当前位置；6 刹车；7 手刹；8 回零；9 中止回零；10 电流爬升；0xFFFF 空模式 |
| **6002**      | 设定电流         | 保持寄存器 | 读写   | `short`，单位 10 mA                                                                  |
| **6003–6004** | 设定转速         | 保持寄存器 | 读写   | `int`，电角度转速，RPM 需 ÷ 极对数                                                           |
| **6005**      | 设定占空比        | 保持寄存器 | 读写   | `short`，范围 −1000 ~ 1000                                                           |
| **6006–6007** | 设定绝对位置       | 保持寄存器 | 读写   | `int`，单位 0.01°                                                                    |
| **6008–6009** | 设定相对位置（上次目标） | 保持寄存器 | 读写   | `int`，单位 0.01°，相对上次目标值                                                            |
| **6010–6011** | 设定相对位置（当前位置） | 保持寄存器 | 读写   | `int`，单位 0.01°，相对当前位置                                                             |
| **6012–6013** | 设定当前位置       | 保持寄存器 | 读写   | `int`，单位 0.01°，设 0 为零点                                                            |
| **6014**      | 设定刹车电流       | 保持寄存器 | 读写   | `short`，单位 10 mA                                                                  |
| **6015**      | 设定手刹电流       | 保持寄存器 | 读写   | `short`，单位 10 mA                                                                  |
| **6016–6017** | 设置速度环加速度     | 保持寄存器 | 读写   | `int`，单位 erpm/s，仅速度环有效                                                            |
| **6018–6019** | 设置轨迹最大速度     | 保持寄存器 | 读写   | `int`，电角度转速，仅轨迹位置有效                                                               |
| **6020–6021** | 设置轨迹最大加速度    | 保持寄存器 | 读写   | `int`，每分钟增加的 erpm，仅轨迹位置有效                                                         |
| **6022–6023** | 设置轨迹最大减速度    | 保持寄存器 | 读写   | `int`，同上                                                                          |
| **6024**      | 当前电机配置表索引    | 保持寄存器 | 读写   | `uint16_t`，0–3；开机默认 0 配置                                                          |
| **6025–6026** | 设置速度环减速度     | 保持寄存器 | 读写   | `int`，单位 erpm/s，仅速度环有效                                                            |
| **6027**      | 回零模式         | 保持寄存器 | 读写   | `uint16_t`，详见上位机配置说明                                                              |
| **6028**      | 闭环模式最大电流     | 保持寄存器 | 读写   | `uin                                                                              |


📘 通信协议概述

驱动器使用 Modbus RTU 协议 进行通信，物理层采用 RS-485 半双工方式。
主机（如 STM32、上位机、PLC 等）作为 Modbus 主站，通过标准功能码访问驱动器（从站）的寄存器，实现运行状态读取与控制指令发送。

⚙️ 通信参数
参数	默认值
波特率	115200 bps
数据位	8
停止位	1
校验位	无
从站地址	1
通信协议	Modbus RTU
📦 Modbus 功能码
功能码	含义	说明
0x03	读保持寄存器	读取驱动器内部参数（如目标转速、心跳寄存器等）
0x04	读输入寄存器	读取实时状态（电流、电压、角度、位置等）
0x06	写单个寄存器	写入一个 16 位数据（例如设定电流、模式）
0x10	写多个寄存器	连续写入多个 16 位数据（如设定目标速度、绝对位置等）
🔄 通信帧结构（Modbus RTU）
字段	字节数	示例	说明
从站地址	1	0x01	驱动器地址
功能码	1	0x03	读保持寄存器
起始地址	2	0x17 0x70	即寄存器 6000
数据长度 / 写入值	2~N	—	根据功能码不同
CRC 校验	2	低字节在前	确保数据完整性

CRC16 使用 Modbus 多项式 0xA001 计算（见文末 C 示例代码）。

🧩 主要寄存器（简要）
地址	说明	类型	读写
5000	故障信息	uint16_t	只读
5001–5002	实时转速（erpm）	int	只读
5008	温度 (°C)	short	只读
5010–5011	实时位置（0.01°）	int	只读
6000	心跳包	uint16_t	读写
6001	控制模式	uint16_t	读写
6002	设定电流（10mA）	short	读写
6003–6004	设定转速（erpm）	int	读写
6006–6007	设定绝对位置（0.01°）	int	读写
❤️ 心跳机制（必须启用）

驱动器具备通信保护机制：

若在设定超时时间内未更新寄存器 6000（心跳包） 的值，电机会自动停止输出。

示例：

若超时时间为 1000 ms，则主机应每隔 500 ms 写入新值：

01 06 17 70 00 01 4C 65   ; 设置心跳值=1
01 06 17 70 00 02 0C 64   ; 500ms 后设置心跳值=2

🔧 常用控制示例
1️⃣ 读取当前转速（erpm）
发送：01 04 13 89 00 02 A4 A5
接收：01 04 04 00 00 05 41 38 E4
结果：0x0541 = 1345 erpm → 转速(rpm) = 1345 / 极对数

2️⃣ 设定电流控制（恒扭矩）
01 06 17 72 00 64 2D 8E    ; 电流 = 1A (100×10mA)
01 06 17 71 00 00 DC 65    ; 模式 = 0 (电流模式)

3️⃣ 设定转速控制（恒速）
01 10 17 73 00 02 04 00 00 0F A0 5A E6  ; 目标转速 = 4000 erpm
01 06 17 71 00 01 1D A5                 ; 模式 = 1 (转速控制)

4️⃣ 设定绝对位置控制（角度）
01 06 17 71 FF FF DD D5                 ; 切换为空模式
01 10 17 76 00 02 04 00 00 8C A0 FB E9  ; 目标位置 36000 (360°)
01 10 17 82 00 02 04 00 00 13 88 9C B0  ; 最大速度 5000 erpm
01 10 17 84 00 02 04 00 00 13 88 1C 9A  ; 加速度 5000 erpm/s²
01 10 17 86 00 02 04 00 00 13 88 9D 43  ; 减速度 5000 erpm/s²
01 06 17 71 00 03 9C 64                 ; 模式 = 3 (绝对位置)

5️⃣ 读取故障信息
01 04 13 88 00 01 B5 64 → 返回 01 04 02 00 00 B9 30
无故障 = 0

🔣 CRC16 校验示例（C语言）
uint16_t Modbus_CRC16(uint8_t *buf, uint16_t len) {
    uint16_t crc = 0xFFFF;
    for (uint16_t i = 0; i < len; i++) {
        crc ^= buf[i];
        for (uint8_t j = 0; j < 8; j++) {
            if (crc & 0x0001)
                crc = (crc >> 1) ^ 0xA001;
            else
                crc >>= 1;
        }
    }
    return crc;  // 低字节在前，高字节在后
}

🧠 编程要点总结

周期发送心跳（6000），否则驱动会断电输出。

所有多字寄存器均为 高字在前、低字在后（大端序）。

功能码 0x06 用于单寄存器控制；0x10 用于写多个寄存器（如目标速度）。

读状态类信息使用 0x04（输入寄存器）。

每次模式切换（6001）时建议先写空模式 (0xFFFF)，再写入目标模式。

建议主机软件在发送前执行 CRC16 校验 并校对响应帧完整性。